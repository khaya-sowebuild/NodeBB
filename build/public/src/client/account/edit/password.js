"use strict";define("forum/account/edit/password",["forum/account/header","translator","zxcvbn"],function(a,s,e){var r={};r.init=function(){a.init();i()};function i(){var a=$("#inputCurrentPassword");var s=$("#password-notify");var r=$("#password-confirm-notify");var i=$("#inputNewPassword");var t=$("#inputNewPasswordAgain");var l=false;var d=false;function u(){var a=e(i.val());l=false;if(i.val().length<ajaxify.data.minimumPasswordLength){n(s,"[[reset_password:password_too_short]]")}else if(i.val().length>512){n(s,"[[error:password-too-long]]")}else if(!utils.isPasswordValid(i.val())){n(s,"[[user:change_password_error]]")}else if(i.val()===ajaxify.data.username){n(s,"[[user:password_same_as_username]]")}else if(i.val()===ajaxify.data.email){n(s,"[[user:password_same_as_email]]")}else if(a.score<ajaxify.data.minimumPasswordStrength){n(s,"[[user:weak_password]]")}else{o(s);l=true}}function f(){if(i.val()!==t.val()){n(r,"[[user:change_password_error_match]]");d=false}else{if(i.val()){o(r)}else{r.parent().removeClass("alert-success alert-danger");r.children().show();r.find(".msg").html("")}d=true}}i.on("blur",u);t.on("blur",f);$("#changePasswordBtn").on("click",function(){u();f();var s=$(this);if(l&&d){s.addClass("disabled").find("i").removeClass("hide");socket.emit("user.changePassword",{currentPassword:a.val(),newPassword:i.val(),uid:ajaxify.data.theirid},function(e){s.removeClass("disabled").find("i").addClass("hide");a.val("");i.val("");t.val("");d=false;l=false;if(e){u();f();return app.alertError(e.message)}if(parseInt(app.user.uid,10)===parseInt(ajaxify.data.uid,10)){window.location.href=config.relative_path+"/login"}else{ajaxify.go("user/"+ajaxify.data.userslug+"/edit")}})}else{if(!d){app.alertError("[[user:change_password_error_match]]")}if(!l){app.alertError("[[user:change_password_error]]")}}return false})}function n(a,e){s.translate(e,function(s){a.html(s);a.parent().removeClass("show-success").addClass("show-danger")})}function o(a){a.html("");a.parent().removeClass("show-danger").addClass("show-success")}return r});
//# sourceMappingURL=public/src/client/account/edit/password.js.map