{"version":3,"sources":["public/src/client/account/edit/username.js"],"names":["define","header","AccountEditUsername","init","$","on","updateUsername","userData","uid","val","username","password","app","alertError","btn","this","addClass","find","removeClass","socket","emit","err","data","message","userslug","utils","slugify","parseInt","user","attr","config","relative_path","text","css","ajaxify","go"],"mappings":"AAAA,aAGAA,OAAO,+BAAgC,wBAAyB,SAAUC,GACzE,IAAIC,KAEJA,EAAoBC,KAAO,WAC1BF,EAAOE,OAEPC,EAAE,cAAcC,GAAG,QAAS,SAASC,IACpC,IAAIC,GACHC,IAAKJ,EAAE,aAAaK,MACpBC,SAAUN,EAAE,qBAAqBK,MACjCE,SAAUP,EAAE,yBAAyBK,OAGtC,IAAKF,EAASG,SAAU,CACvB,OAGD,GAAIH,EAASG,WAAaH,EAASI,SAAU,CAC5C,OAAOC,IAAIC,WAAW,sCAGvB,IAAIC,EAAMV,EAAEW,MACZD,EAAIE,SAAS,YAAYC,KAAK,KAAKC,YAAY,QAC/CC,OAAOC,KAAK,2BAA4Bb,EAAU,SAAUc,EAAKC,GAChER,EAAII,YAAY,YAAYD,KAAK,KAAKD,SAAS,QAC/C,GAAIK,EAAK,CACR,OAAOT,IAAIC,WAAWQ,EAAIE,SAG3B,IAAIC,EAAWC,MAAMC,QAAQnB,EAASG,UACtC,GAAIH,EAASG,UAAYc,GAAYG,SAASpB,EAASC,IAAK,MAAQmB,SAASf,IAAIgB,KAAKpB,IAAK,IAAK,CAC/FJ,EAAE,oCAAoCyB,KAAK,OAAQC,OAAOC,cAAgB,SAAWP,GACrFpB,EAAE,yCAAyCyB,KAAK,OAAQC,OAAOC,cAAgB,SAAWP,EAAW,SACrGpB,EAAE,6CAA6CyB,KAAK,OAAQC,OAAOC,cAAgB,SAAWP,EAAW,aACzGpB,EAAE,iCAAiC4B,KAAKzB,EAASG,UACjDN,EAAE,iCAAiC6B,IAAI,mBAAoBX,EAAK,iBAAiBU,KAAKV,EAAK,cAG5FY,QAAQC,GAAG,QAAUX,EAAW,WAGjC,OAAO,SAIT,OAAOtB","file":"public/src/client/account/edit/username.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/account/edit/username', ['forum/account/header'], function (header) {\r\n\tvar AccountEditUsername = {};\r\n\r\n\tAccountEditUsername.init = function () {\r\n\t\theader.init();\r\n\r\n\t\t$('#submitBtn').on('click', function updateUsername() {\r\n\t\t\tvar userData = {\r\n\t\t\t\tuid: $('#inputUID').val(),\r\n\t\t\t\tusername: $('#inputNewUsername').val(),\r\n\t\t\t\tpassword: $('#inputCurrentPassword').val(),\r\n\t\t\t};\r\n\r\n\t\t\tif (!userData.username) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (userData.username === userData.password) {\r\n\t\t\t\treturn app.alertError('[[user:username_same_as_password]]');\r\n\t\t\t}\r\n\r\n\t\t\tvar btn = $(this);\r\n\t\t\tbtn.addClass('disabled').find('i').removeClass('hide');\r\n\t\t\tsocket.emit('user.changeUsernameEmail', userData, function (err, data) {\r\n\t\t\t\tbtn.removeClass('disabled').find('i').addClass('hide');\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar userslug = utils.slugify(userData.username);\r\n\t\t\t\tif (userData.username && userslug && parseInt(userData.uid, 10) === parseInt(app.user.uid, 10)) {\r\n\t\t\t\t\t$('[component=\"header/profilelink\"]').attr('href', config.relative_path + '/user/' + userslug);\r\n\t\t\t\t\t$('[component=\"header/profilelink/edit\"]').attr('href', config.relative_path + '/user/' + userslug + '/edit');\r\n\t\t\t\t\t$('[component=\"header/profilelink/settings\"]').attr('href', config.relative_path + '/user/' + userslug + '/settings');\r\n\t\t\t\t\t$('[component=\"header/username\"]').text(userData.username);\r\n\t\t\t\t\t$('[component=\"header/usericon\"]').css('background-color', data['icon:bgColor']).text(data['icon:text']);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tajaxify.go('user/' + userslug + '/edit');\r\n\t\t\t});\r\n\r\n\t\t\treturn false;\r\n\t\t});\r\n\t};\r\n\r\n\treturn AccountEditUsername;\r\n});\r\n"]}