{"version":3,"sources":["public/src/client/account/profile.js"],"names":["define","header","infinitescroll","Account","theirid","init","ajaxify","data","app","enterRoom","processPage","socket","removeListener","onUserStatusChange","on","config","usePagination","loadMorePosts","$","addClass","parseInt","uid","updateUserStatus","status","direction","length","removeClass","loadMore","after","attr","done","posts","onPostsLoaded","nextStart","callback","filter","post","pid","parseAndTranslate","html","append","find","timeago"],"mappings":"AAAA,aAGAA,OAAO,yBACN,uBACA,uBACA,cACE,SAAUC,EAAQC,GACpB,IAAIC,KACJ,IAAIC,EAEJD,EAAQE,KAAO,WACdJ,EAAOI,OAEPD,EAAUE,QAAQC,KAAKH,QAEvBI,IAAIC,UAAU,QAAUL,GAExBM,IAEAC,OAAOC,eAAe,2BAA4BC,GAClDF,OAAOG,GAAG,2BAA4BD,GAEtC,IAAKE,OAAOC,cAAe,CAC1Bd,EAAeG,KAAKY,KAItB,SAASP,IACRQ,EAAE,gGAAgGC,SAAS,kBAG5G,SAASN,EAAmBN,GAC3B,GAAIa,SAASd,QAAQC,KAAKH,QAAS,MAAQgB,SAASb,EAAKc,IAAK,IAAK,CAClE,OAGDb,IAAIc,iBAAiBJ,EAAE,uBAAyBX,EAAKc,IAAM,gCAAiCd,EAAKgB,QAGlG,SAASN,EAAcO,GACtB,GAAIA,EAAY,IAAMN,EAAE,uBAAuBO,OAAQ,CACtD,OAGDP,EAAE,+BAA+BQ,YAAY,UAE7CxB,EAAeyB,SAAS,2BACvBC,MAAOV,EAAE,uBAAuBW,KAAK,kBACrCR,IAAKjB,GACH,SAAUG,EAAMuB,GAClB,GAAIvB,EAAKwB,OAASxB,EAAKwB,MAAMN,OAAQ,CACpCO,EAAczB,EAAKwB,MAAOD,OACpB,CACNA,IAEDZ,EAAE,uBAAuBW,KAAK,iBAAkBtB,EAAK0B,WACrDf,EAAE,+BAA+BC,SAAS,YAI5C,SAASa,EAAcD,EAAOG,GAC7BH,EAAQA,EAAMI,OAAO,SAAUC,GAC9B,OAAQlB,EAAE,iCAAmCkB,EAAKC,IAAM,KAAKZ,SAG9D,IAAKM,EAAMN,OAAQ,CAClB,OAAOS,IAGR1B,IAAI8B,kBAAkB,kBAAmB,SAAWP,MAAOA,GAAS,SAAUQ,GAC7ErB,EAAE,uBAAuBsB,OAAOD,GAChCA,EAAKE,KAAK,YAAYC,UAEtBR,MAIF,OAAO/B","file":"public/src/client/account/profile.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/account/profile', [\r\n\t'forum/account/header',\r\n\t'forum/infinitescroll',\r\n\t'components',\r\n], function (header, infinitescroll) {\r\n\tvar Account = {};\r\n\tvar theirid;\r\n\r\n\tAccount.init = function () {\r\n\t\theader.init();\r\n\r\n\t\ttheirid = ajaxify.data.theirid;\r\n\r\n\t\tapp.enterRoom('user/' + theirid);\r\n\r\n\t\tprocessPage();\r\n\r\n\t\tsocket.removeListener('event:user_status_change', onUserStatusChange);\r\n\t\tsocket.on('event:user_status_change', onUserStatusChange);\r\n\r\n\t\tif (!config.usePagination) {\r\n\t\t\tinfinitescroll.init(loadMorePosts);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction processPage() {\r\n\t\t$('[component=\"posts\"] img:not(.not-responsive), [component=\"aboutme\"] img:not(.not-responsive)').addClass('img-responsive');\r\n\t}\r\n\r\n\tfunction onUserStatusChange(data) {\r\n\t\tif (parseInt(ajaxify.data.theirid, 10) !== parseInt(data.uid, 10)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tapp.updateUserStatus($('.account [data-uid=\"' + data.uid + '\"] [component=\"user/status\"]'), data.status);\r\n\t}\r\n\r\n\tfunction loadMorePosts(direction) {\r\n\t\tif (direction < 0 || !$('[component=\"posts\"]').length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$('[component=\"posts/loading\"]').removeClass('hidden');\r\n\r\n\t\tinfinitescroll.loadMore('posts.loadMoreUserPosts', {\r\n\t\t\tafter: $('[component=\"posts\"]').attr('data-nextstart'),\r\n\t\t\tuid: theirid,\r\n\t\t}, function (data, done) {\r\n\t\t\tif (data.posts && data.posts.length) {\r\n\t\t\t\tonPostsLoaded(data.posts, done);\r\n\t\t\t} else {\r\n\t\t\t\tdone();\r\n\t\t\t}\r\n\t\t\t$('[component=\"posts\"]').attr('data-nextstart', data.nextStart);\r\n\t\t\t$('[component=\"posts/loading\"]').addClass('hidden');\r\n\t\t});\r\n\t}\r\n\r\n\tfunction onPostsLoaded(posts, callback) {\r\n\t\tposts = posts.filter(function (post) {\r\n\t\t\treturn !$('[component=\"posts\"] [data-pid=' + post.pid + ']').length;\r\n\t\t});\r\n\r\n\t\tif (!posts.length) {\r\n\t\t\treturn callback();\r\n\t\t}\r\n\r\n\t\tapp.parseAndTranslate('account/profile', 'posts', { posts: posts }, function (html) {\r\n\t\t\t$('[component=\"posts\"]').append(html);\r\n\t\t\thtml.find('.timeago').timeago();\r\n\r\n\t\t\tcallback();\r\n\t\t});\r\n\t}\r\n\r\n\treturn Account;\r\n});\r\n"]}