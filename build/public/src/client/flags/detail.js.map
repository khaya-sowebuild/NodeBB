{"version":3,"sources":["public/src/client/flags/detail.js"],"names":["define","FlagsList","components","translator","Benchpress","Flags","init","$","val","ajaxify","data","state","removeAttr","assignee","on","action","this","getAttribute","socket","emit","flagId","serializeArray","err","history","app","alertError","message","alertSuccess","reloadHistory","note","document","getElementById","value","payload","reloadNotes","notes","enableFilterForm","enableChatButtons","parse","html","wrapperEl","get","empty","find","timeago","translate","translated"],"mappings":"AAAA,aAIAA,OAAO,sBAAuB,mBAAoB,aAAc,aAAc,cAAe,SAAUC,EAAWC,EAAYC,EAAYC,GACzI,IAAIC,KAEJA,EAAMC,KAAO,WAEZC,EAAE,UAAUC,IAAIC,QAAQC,KAAKC,OAAOC,WAAW,YAC/CL,EAAE,aAAaC,IAAIC,QAAQC,KAAKG,UAAUD,WAAW,YAErDL,EAAE,iBAAiBO,GAAG,QAAS,WAC9B,IAAIC,EAASC,KAAKC,aAAa,eAE/B,OAAQF,GACR,IAAK,SACJG,OAAOC,KAAK,gBACXC,OAAQX,QAAQC,KAAKU,OACrBV,KAAMH,EAAE,eAAec,kBACrB,SAAUC,EAAKC,GACjB,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAE3BF,IAAIG,aAAa,qBACjBtB,EAAMuB,cAAcL,KAErB,MAED,IAAK,aACJL,OAAOC,KAAK,oBACXC,OAAQX,QAAQC,KAAKU,OACrBS,KAAMC,SAASC,eAAe,QAAQC,OACpC,SAAUV,EAAKW,GACjB,GAAIX,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAE3BF,IAAIG,aAAa,wBACjBtB,EAAM6B,YAAYD,EAAQE,OAC1B9B,EAAMuB,cAAcK,EAAQV,WAE7B,SAIFtB,EAAUmC,mBACVnC,EAAUoC,qBAGXhC,EAAM6B,YAAc,SAAUC,GAC7B/B,EAAWkC,MAAM,eAAgB,SAChCH,MAAOA,GACL,SAAUI,GACZ,IAAIC,EAAYtC,EAAWuC,IAAI,cAC/BD,EAAUE,QACVF,EAAUD,KAAKA,GACfC,EAAUG,KAAK,gBAAgBC,UAC/Bd,SAASC,eAAe,QAAQC,MAAQ,MAI1C3B,EAAMuB,cAAgB,SAAUL,GAC/BnB,EAAWkC,MAAM,eAAgB,WAChCf,QAASA,GACP,SAAUgB,GACZpC,EAAW0C,UAAUN,EAAM,SAAUO,GACpC,IAAIN,EAAYtC,EAAWuC,IAAI,gBAC/BD,EAAUE,QACVF,EAAUD,KAAKO,GACfN,EAAUG,KAAK,gBAAgBC,eAKlC,OAAOvC","file":"public/src/client/flags/detail.js","sourcesContent":["'use strict';\r\n\r\n/* globals define */\r\n\r\ndefine('forum/flags/detail', ['forum/flags/list', 'components', 'translator', 'benchpress'], function (FlagsList, components, translator, Benchpress) {\r\n\tvar Flags = {};\r\n\r\n\tFlags.init = function () {\r\n\t\t// Update attributes\r\n\t\t$('#state').val(ajaxify.data.state).removeAttr('disabled');\r\n\t\t$('#assignee').val(ajaxify.data.assignee).removeAttr('disabled');\r\n\r\n\t\t$('[data-action]').on('click', function () {\r\n\t\t\tvar action = this.getAttribute('data-action');\r\n\r\n\t\t\tswitch (action) {\r\n\t\t\tcase 'update':\r\n\t\t\t\tsocket.emit('flags.update', {\r\n\t\t\t\t\tflagId: ajaxify.data.flagId,\r\n\t\t\t\t\tdata: $('#attributes').serializeArray(),\r\n\t\t\t\t}, function (err, history) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapp.alertSuccess('[[flags:updated]]');\r\n\t\t\t\t\tFlags.reloadHistory(history);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'appendNote':\r\n\t\t\t\tsocket.emit('flags.appendNote', {\r\n\t\t\t\t\tflagId: ajaxify.data.flagId,\r\n\t\t\t\t\tnote: document.getElementById('note').value,\r\n\t\t\t\t}, function (err, payload) {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapp.alertSuccess('[[flags:note-added]]');\r\n\t\t\t\t\tFlags.reloadNotes(payload.notes);\r\n\t\t\t\t\tFlags.reloadHistory(payload.history);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tFlagsList.enableFilterForm();\r\n\t\tFlagsList.enableChatButtons();\r\n\t};\r\n\r\n\tFlags.reloadNotes = function (notes) {\r\n\t\tBenchpress.parse('flags/detail', 'notes', {\r\n\t\t\tnotes: notes,\r\n\t\t}, function (html) {\r\n\t\t\tvar wrapperEl = components.get('flag/notes');\r\n\t\t\twrapperEl.empty();\r\n\t\t\twrapperEl.html(html);\r\n\t\t\twrapperEl.find('span.timeago').timeago();\r\n\t\t\tdocument.getElementById('note').value = '';\r\n\t\t});\r\n\t};\r\n\r\n\tFlags.reloadHistory = function (history) {\r\n\t\tBenchpress.parse('flags/detail', 'history', {\r\n\t\t\thistory: history,\r\n\t\t}, function (html) {\r\n\t\t\ttranslator.translate(html, function (translated) {\r\n\t\t\t\tvar wrapperEl = components.get('flag/history');\r\n\t\t\t\twrapperEl.empty();\r\n\t\t\t\twrapperEl.html(translated);\r\n\t\t\t\twrapperEl.find('span.timeago').timeago();\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\treturn Flags;\r\n});\r\n"]}