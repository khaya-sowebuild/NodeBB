"use strict";define("forum/footer",["notifications","chat","components","translator"],function(t,n,e,a){t.prepareDOM();n.prepareDOM();a.prepareDOM();function i(t,n){if(!utils.isNumber(n)){return}$('a[href="'+config.relative_path+t+'"].navigation-link i').toggleClass("unread-count",n>0).attr("data-content",n>99?"99+":n)}function r(t){e.get("chat/icon").toggleClass("unread-count",t>0).attr("data-content",t>99?"99+":t)}function o(){var t={};function n(n){if(n&&n.posts&&n.posts.length){var i=n.posts[0];if(parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!t[i.topic.tid]){e(n);a(i.topic.tid);t[i.topic.tid]=true}}}function e(t){var n=t.posts[0];var e=parseInt($('a[href="'+config.relative_path+'/unread"].navigation-link i').attr("data-content"),10)+1;i("/unread",e);var a=n.isMain&&parseInt(n.uid,10)!==parseInt(app.user.uid,10);if(a){var r=parseInt($('a[href="'+config.relative_path+'/unread?filter=new"].navigation-link i').attr("data-content"),10)+1;i("/unread?filter=new",r)}var o=parseInt(n.topic.postcount,10)<=1;if(o){var u=parseInt($('a[href="'+config.relative_path+'/unread?filter=unreplied"].navigation-link i').attr("data-content"),10)+1;i("/unread?filter=unreplied",u)}socket.emit("topics.isFollowed",n.topic.tid,function(t,n){if(t){return app.alertError(t.message)}if(n){var e=parseInt($('a[href="'+config.relative_path+'/unread?filter=watched"].navigation-link i').attr("data-content"),10)+1;i("/unread?filter=watched",e)}})}function a(t){$('[data-tid="'+t+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(n,e){if(e.url){var a=e.url.match(/^topic\/(\d+)/);if(a&&a[1]){delete t[a[1]]}}});socket.on("event:new_post",n)}function u(t){i("/unread",t.unreadTopicCount);i("/unread?filter=new",t.unreadNewTopicCount);i("/unread?filter=watched",t.unreadWatchedTopicCount);i("/unread?filter=unreplied",t.unreadUnrepliedTopicCount)}socket.on("event:unread.updateCount",u);socket.on("event:unread.updateChatCount",r);o()});
//# sourceMappingURL=public/src/client/footer.js.map