{"version":3,"sources":["public/src/client/top.js"],"names":["define","recent","infinitescroll","Top","$","window","on","ev","data","ajaxify","currentPage","url","removeListeners","init","app","enterRoom","watchForNewPosts","handleCategorySelection","this","addClass","config","usePagination","loadMoreTopics","trigger","topics","direction","length","loadMore","after","attr","count","topicsPerPage","cid","utils","params","term","selectedTerm","filter","selectedFilter","done","onTopicsLoaded","nextStart","hide"],"mappings":"AAAA,aAEAA,OAAO,aAAc,eAAgB,wBAAyB,SAAUC,EAAQC,GAC/E,IAAIC,KAEJC,EAAEC,QAAQC,GAAG,uBAAwB,SAAUC,EAAIC,GAClD,GAAIC,QAAQC,cAAgBF,EAAKG,IAAK,CACrCV,EAAOW,qBAITT,EAAIU,KAAO,WACVC,IAAIC,UAAU,cAEdd,EAAOe,mBAEPf,EAAOgB,0BAEPb,EAAE,qBAAqBE,GAAG,QAAS,WAClCF,EAAEc,MAAMC,SAAS,UAGlB,IAAKC,OAAOC,cAAe,CAC1BnB,EAAeW,KAAKS,GAGrBlB,EAAEC,QAAQkB,QAAQ,wBAA0BC,OAAQf,QAAQD,KAAKgB,UAGlE,SAASF,EAAeG,GACvB,GAAIA,EAAY,IAAMrB,EAAE,0BAA0BsB,OAAQ,CACzD,OAGDxB,EAAeyB,SAAS,4BACvBC,MAAOxB,EAAE,0BAA0ByB,KAAK,kBACxCC,MAAOV,OAAOW,cACdC,IAAKC,MAAMC,SAASF,IACpBG,KAAM1B,QAAQD,KAAK4B,aAAaD,KAChCE,OAAQ5B,QAAQD,KAAK8B,eAAeD,QAClC,SAAU7B,EAAM+B,GAClB,GAAI/B,EAAKgB,QAAUhB,EAAKgB,OAAOE,OAAQ,CACtCzB,EAAOuC,eAAe,MAAOhC,EAAKgB,OAAQ,KAAMC,EAAWc,GAC3DnC,EAAE,0BAA0ByB,KAAK,iBAAkBrB,EAAKiC,eAClD,CACNF,IACAnC,EAAE,kBAAkBsC,UAKvB,OAAOvC","file":"public/src/client/top.js","sourcesContent":["'use strict';\r\n\r\ndefine('forum/top', ['forum/recent', 'forum/infinitescroll'], function (recent, infinitescroll) {\r\n\tvar\tTop = {};\r\n\r\n\t$(window).on('action:ajaxify.start', function (ev, data) {\r\n\t\tif (ajaxify.currentPage !== data.url) {\r\n\t\t\trecent.removeListeners();\r\n\t\t}\r\n\t});\r\n\r\n\tTop.init = function () {\r\n\t\tapp.enterRoom('top_topics');\r\n\r\n\t\trecent.watchForNewPosts();\r\n\r\n\t\trecent.handleCategorySelection();\r\n\r\n\t\t$('#new-topics-alert').on('click', function () {\r\n\t\t\t$(this).addClass('hide');\r\n\t\t});\r\n\r\n\t\tif (!config.usePagination) {\r\n\t\t\tinfinitescroll.init(loadMoreTopics);\r\n\t\t}\r\n\r\n\t\t$(window).trigger('action:topics.loaded', { topics: ajaxify.data.topics });\r\n\t};\r\n\r\n\tfunction loadMoreTopics(direction) {\r\n\t\tif (direction < 0 || !$('[component=\"category\"]').length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tinfinitescroll.loadMore('topics.loadMoreTopTopics', {\r\n\t\t\tafter: $('[component=\"category\"]').attr('data-nextstart'),\r\n\t\t\tcount: config.topicsPerPage,\r\n\t\t\tcid: utils.params().cid,\r\n\t\t\tterm: ajaxify.data.selectedTerm.term,\r\n\t\t\tfilter: ajaxify.data.selectedFilter.filter,\r\n\t\t}, function (data, done) {\r\n\t\t\tif (data.topics && data.topics.length) {\r\n\t\t\t\trecent.onTopicsLoaded('top', data.topics, true, direction, done);\r\n\t\t\t\t$('[component=\"category\"]').attr('data-nextstart', data.nextStart);\r\n\t\t\t} else {\r\n\t\t\t\tdone();\r\n\t\t\t\t$('#load-more-btn').hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn Top;\r\n});\r\n"]}