"use strict";define("forum/topic/diffs",["forum/topic/images","benchpress","translator"],function(t,e,n){var s={};s.open=function(t){if(!config.enablePostHistory){return}var o={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};socket.emit("posts.getDiffs",{pid:t},function(i,r){if(i){return app.alertError(i.message)}e.parse("partials/modals/post_history",{diffs:r.map(function(t){t=parseInt(t,10);return{timestamp:t,pretty:new Date(t).toLocaleString(config.userLang.replace("_","-"),o)}}),numDiffs:r.length},function(e){n.translate(e,function(e){var n=bootbox.dialog({title:"[[topic:diffs.title]]",message:e,size:"large"});if(!r.length){return}var o=n.find("select");var i=n.find("ul.posts-list");o.on("change",function(){s.load(t,this.value,i)});n.on("shown.bs.modal",function(){s.load(t,o.val(),i)})})})})};s.load=function(e,n,s){if(!config.enablePostHistory){return}socket.emit("posts.showPostAt",{pid:e,since:n},function(e,n){if(e){return app.alertError(e.message)}n.deleted=!!parseInt(n.deleted,10);app.parseAndTranslate("partials/posts_list","posts",{posts:[n]},function(e){s.empty().append(e);t.unloadImages(e);t.loadImages()})})};return s});
//# sourceMappingURL=public/src/client/topic/diffs.js.map