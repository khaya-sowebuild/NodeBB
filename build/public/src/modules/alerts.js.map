{"version":3,"sources":["public/src/modules/alerts.js"],"names":["define","translator","components","Benchpress","module","alert","params","alert_id","Date","getTime","title","trim","message","type","$","length","updateAlert","createNew","parse","alertTpl","translate","translatedHTML","fadeIn","get","prepend","closefn","find","on","fadeOut","timeout","startTimeout","clickfn","addClass","e","target","is","remove","id","html","attr","clearTimeout","parseInt","children","off","removeClass","this","timeoutId","setTimeout","css"],"mappings":"AAAA,aAGAA,OAAO,UAAW,aAAc,aAAc,cAAe,SAAUC,EAAYC,EAAYC,GAC9F,IAAIC,KAEJA,EAAOC,MAAQ,SAAUC,GACxBA,EAAOC,SAAW,iBAAmBD,EAAOC,SAAWD,EAAOC,UAAW,IAAIC,MAAOC,WACpFH,EAAOI,MAAQJ,EAAOI,MAAQJ,EAAOI,MAAMC,QAAU,GAAK,GAC1DL,EAAOM,QAAUN,EAAOM,QAAUN,EAAOM,QAAQD,OAAS,GAC1DL,EAAOO,KAAOP,EAAOO,MAAQ,OAE7B,IAAIR,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjBC,EAAYX,EAAOC,OACb,CACNW,EAAUX,KAIZ,SAASW,EAAUX,GAClBH,EAAWe,MAAM,QAASZ,EAAQ,SAAUa,GAC3ClB,EAAWmB,UAAUD,EAAU,SAAUE,GACxC,IAAIhB,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjB,OAAOC,EAAYX,EAAOC,GAE3BD,EAAQS,EAAEO,GACVhB,EAAMiB,OAAO,KAEbpB,EAAWqB,IAAI,gBAAgBC,QAAQnB,GAEvC,UAAWC,EAAOmB,UAAY,WAAY,CACzCpB,EAAMqB,KAAK,UAAUC,GAAG,QAAS,WAChCrB,EAAOmB,UACPG,EAAQvB,GACR,OAAO,QAIT,GAAIC,EAAOuB,QAAS,CACnBC,EAAazB,EAAOC,EAAOuB,SAG5B,UAAWvB,EAAOyB,UAAY,WAAY,CACzC1B,EACE2B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKnB,EAAEmB,EAAEC,QAAQC,GAAG,UAAW,CAC9B7B,EAAOyB,UAERH,EAAQvB,UAOdD,EAAOgC,OAAS,SAAUC,GACzBvB,EAAE,iBAAmBuB,GAAID,UAG1B,SAASpB,EAAYX,EAAOC,GAC3BD,EAAMqB,KAAK,UAAUY,KAAKhC,EAAOI,OACjCL,EAAMqB,KAAK,KAAKY,KAAKhC,EAAOM,SAC5BP,EAAMkC,KAAK,QAAS,iCAAmCjC,EAAOO,KAAO,aAErE2B,aAAaC,SAASpC,EAAMkC,KAAK,aAAc,KAC/C,GAAIjC,EAAOuB,QAAS,CACnBC,EAAazB,EAAOC,EAAOuB,SAG5BxB,EAAMqC,WAAWd,QAAQ,KACzB3B,EAAWmB,UAAUf,EAAMiC,OAAQ,SAAUjB,GAC5ChB,EAAMqC,WAAWpB,OAAO,KACxBjB,EAAMiC,KAAKjB,KAIZhB,EAAMsC,IAAI,SAASC,YAAY,WAC/B,UAAWtC,EAAOyB,UAAY,WAAY,CACzC1B,EACE2B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKnB,EAAEmB,EAAEC,QAAQC,GAAG,UAAW,CAC9B7B,EAAOyB,UAERH,EAAQvB,MAKZ,SAASuB,EAAQvB,GAChBA,EAAMuB,QAAQ,IAAK,WAClBd,EAAE+B,MAAMT,WAIV,SAASN,EAAazB,EAAOwB,GAC5B,IAAIiB,EAAYC,WAAW,WAC1BnB,EAAQvB,IACNwB,GAEHxB,EAAMkC,KAAK,YAAaO,GAGxBzC,EAAM2C,IAAI,sBAAuB,QACjC3C,EAAMuC,YAAY,WAElBG,WAAW,WACV1C,EAAM2C,IAAI,sBAAuB,IACjC3C,EAAM2C,IAAI,aAAc,UAAYnB,EAAU,KAAO,gCAAkCA,EAAU,KAAO,cACxGxB,EAAM2B,SAAS,YACb,IAGH3B,EACEsB,GAAG,aAAc,WACjBb,EAAE+B,MAAMG,IAAI,sBAAuB,KAItC,OAAO5C","file":"public/src/modules/alerts.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('alerts', ['translator', 'components', 'benchpress'], function (translator, components, Benchpress) {\r\n\tvar module = {};\r\n\r\n\tmodule.alert = function (params) {\r\n\t\tparams.alert_id = 'alert_button_' + (params.alert_id ? params.alert_id : new Date().getTime());\r\n\t\tparams.title = params.title ? params.title.trim() || '' : '';\r\n\t\tparams.message = params.message ? params.message.trim() : '';\r\n\t\tparams.type = params.type || 'info';\r\n\r\n\t\tvar alert = $('#' + params.alert_id);\r\n\t\tif (alert.length) {\r\n\t\t\tupdateAlert(alert, params);\r\n\t\t} else {\r\n\t\t\tcreateNew(params);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction createNew(params) {\r\n\t\tBenchpress.parse('alert', params, function (alertTpl) {\r\n\t\t\ttranslator.translate(alertTpl, function (translatedHTML) {\r\n\t\t\t\tvar alert = $('#' + params.alert_id);\r\n\t\t\t\tif (alert.length) {\r\n\t\t\t\t\treturn updateAlert(alert, params);\r\n\t\t\t\t}\r\n\t\t\t\talert = $(translatedHTML);\r\n\t\t\t\talert.fadeIn(200);\r\n\r\n\t\t\t\tcomponents.get('toaster/tray').prepend(alert);\r\n\r\n\t\t\t\tif (typeof params.closefn === 'function') {\r\n\t\t\t\t\talert.find('button').on('click', function () {\r\n\t\t\t\t\t\tparams.closefn();\r\n\t\t\t\t\t\tfadeOut(alert);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (params.timeout) {\r\n\t\t\t\t\tstartTimeout(alert, params.timeout);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof params.clickfn === 'function') {\r\n\t\t\t\t\talert\r\n\t\t\t\t\t\t.addClass('pointer')\r\n\t\t\t\t\t\t.on('click', function (e) {\r\n\t\t\t\t\t\t\tif (!$(e.target).is('.close')) {\r\n\t\t\t\t\t\t\t\tparams.clickfn();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfadeOut(alert);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tmodule.remove = function (id) {\r\n\t\t$('#alert_button_' + id).remove();\r\n\t};\r\n\r\n\tfunction updateAlert(alert, params) {\r\n\t\talert.find('strong').html(params.title);\r\n\t\talert.find('p').html(params.message);\r\n\t\talert.attr('class', 'alert alert-dismissable alert-' + params.type + ' clearfix');\r\n\r\n\t\tclearTimeout(parseInt(alert.attr('timeoutId'), 10));\r\n\t\tif (params.timeout) {\r\n\t\t\tstartTimeout(alert, params.timeout);\r\n\t\t}\r\n\r\n\t\talert.children().fadeOut(100);\r\n\t\ttranslator.translate(alert.html(), function (translatedHTML) {\r\n\t\t\talert.children().fadeIn(100);\r\n\t\t\talert.html(translatedHTML);\r\n\t\t});\r\n\r\n\t\t// Handle changes in the clickfn\r\n\t\talert.off('click').removeClass('pointer');\r\n\t\tif (typeof params.clickfn === 'function') {\r\n\t\t\talert\r\n\t\t\t\t.addClass('pointer')\r\n\t\t\t\t.on('click', function (e) {\r\n\t\t\t\t\tif (!$(e.target).is('.close')) {\r\n\t\t\t\t\t\tparams.clickfn();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfadeOut(alert);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction fadeOut(alert) {\r\n\t\talert.fadeOut(500, function () {\r\n\t\t\t$(this).remove();\r\n\t\t});\r\n\t}\r\n\r\n\tfunction startTimeout(alert, timeout) {\r\n\t\tvar timeoutId = setTimeout(function () {\r\n\t\t\tfadeOut(alert);\r\n\t\t}, timeout);\r\n\r\n\t\talert.attr('timeoutId', timeoutId);\r\n\r\n\t\t// Reset and start animation\r\n\t\talert.css('transition-property', 'none');\r\n\t\talert.removeClass('animate');\r\n\r\n\t\tsetTimeout(function () {\r\n\t\t\talert.css('transition-property', '');\r\n\t\t\talert.css('transition', 'width ' + (timeout + 450) + 'ms linear, background-color ' + (timeout + 450) + 'ms ease-in');\r\n\t\t\talert.addClass('animate');\r\n\t\t}, 50);\r\n\r\n\t\t// Handle mouseenter/mouseleave\r\n\t\talert\r\n\t\t\t.on('mouseenter', function () {\r\n\t\t\t\t$(this).css('transition-duration', 0);\r\n\t\t\t});\r\n\t}\r\n\r\n\treturn module;\r\n});\r\n"]}