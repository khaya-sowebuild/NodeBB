"use strict";define("composer/tags",function(){var t={};t.init=function(t,n){var o=t.find(".tags");if(!o.length){return}o.tagsinput({maxTags:config.maximumTagsPerTopic,maxChars:config.maximumTagLength,confirmKeys:[13,44],trimValue:true});o.on("beforeItemAdd",function(t){var e=utils.cleanUpTag(t.item,config.maximumTagLength);var i=e!==t.item;t.cancel=i||t.item.length<config.minimumTagLength||t.item.length>config.maximumTagLength;if(t.item.length<config.minimumTagLength){return app.alertError("[[error:tag-too-short, "+config.minimumTagLength+"]]")}else if(t.item.length>config.maximumTagLength){return app.alertError("[[error:tag-too-long, "+config.maximumTagLength+"]]")}if(i){o.tagsinput("add",e)}});o.on("itemAdded",function(t){var e=n.hasOwnProperty("cid")?n.cid:ajaxify.data.cid;socket.emit("topics.isTagAllowed",{tag:t.item,cid:e||0},function(i,a){if(i){return app.alertError(i.message)}if(!a){return o.tagsinput("remove",t.item)}$(window).trigger("action:tag.added",{cid:e,tagEl:o,tag:t.item})})});a(n.tags,o);var r=t.find(".bootstrap-tagsinput input");e(t,n,ajaxify.data);app.loadJQueryUI(function(){r.autocomplete({delay:100,position:{my:"left bottom",at:"left top",collision:"flip"},appendTo:t.find(".bootstrap-tagsinput"),open:function(){$(this).autocomplete("widget").css("z-index",2e4)},source:function(t,e){socket.emit("topics.autocompleteTags",{query:t.term,cid:n.cid},function(t,i){if(t){return app.alertError(t.message)}if(i){e(i)}$(".ui-autocomplete a").attr("data-ajaxify","false")})},select:function(t,e){i(r)}})});r.attr("tabIndex",o.attr("tabIndex"));r.attr("size",o.attr("placeholder").length);r.on("blur",function(){i(r)});$('[component="composer/tag/dropdown"]').on("click","li",function(){var t=$(this).attr("data-tag");if(t){a([t],o)}return false})};t.onChangeCategory=function(t,i,a){$.get("/api/category/"+a,function(a){var n=t.find('[component="composer/tag/dropdown"]');if(!n.length){return}e(t,i,a);n.toggleClass("hidden",!a.tagWhitelist.length);app.parseAndTranslate("composer","tagWhitelist",{tagWhitelist:a.tagWhitelist},function(t){n.find(".dropdown-menu").html(t)})})};function e(t,e,i){var a=t.find(".tags");var n=t.find(".bootstrap-tagsinput input");if(!n.length){return}if(i.tagWhitelist&&i.tagWhitelist.length){n.attr("readonly","");n.attr("placeholder","");a.tagsinput("items").slice().forEach(function(t){if(i.tagWhitelist.indexOf(t)===-1){a.tagsinput("remove",t)}})}else{n.removeAttr("readonly");n.attr("placeholder",t.find("input.tags").attr("placeholder"))}t.find(".tags-container").toggleClass("hidden",i.privileges&&i.privileges.hasOwnProperty("topics:tag")&&!i.privileges["topics:tag"]||config.maximumTagsPerTopic===0&&!e.tags.length);if(i.privileges&&i.privileges.hasOwnProperty("topics:tag")&&!i.privileges["topics:tag"]){a.tagsinput("removeAll")}$(window).trigger("action:tag.toggleInput",{postContainer:t,tagWhitelist:i.tagWhitelist,tagsInput:n})}function i(t){var e=jQuery.Event("keypress");e.which=13;e.keyCode=13;setTimeout(function(){t.trigger(e)},100)}function a(t,e){if(t&&t.length){for(var i=0;i<t.length;++i){e.tagsinput("add",t[i])}}}t.getTags=function(t){return $('.composer[data-uuid="'+t+'"]'+" .tags").tagsinput("items")};return t});
//# sourceMappingURL=node_modules/nodebb-plugin-composer-default/static/lib/composer/tags.js.map