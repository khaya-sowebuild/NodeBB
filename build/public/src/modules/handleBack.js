"use strict";define("handleBack",["components","storage","navigator","forum/pagination"],function(t,o,e,a){var i={};var n;i.init=function(t){n=t;c();$(window).off("action:popstate",r).on("action:popstate",r)};function c(){$('[component="category"]').on("click",'[component="topic/header"]',function(){var t=$(this).parents("[data-index]").attr("data-index");$('[component="category/topic"]').each(function(e,a){if($(a).offset().top-$(window).scrollTop()>0){o.setItem("category:bookmark",$(a).attr("data-index"));o.setItem("category:bookmark:clicked",t);return false}})})}function r(){if(ajaxify.data.template.category||ajaxify.data.template.recent){var t=o.getItem("category:bookmark");var e=o.getItem("category:bookmark:clicked");o.removeItem("category:bookmark");o.removeItem("category:bookmark:clicked");if(!utils.isNumber(t)){return}t=Math.max(0,parseInt(t,10)||0);e=Math.max(0,parseInt(e,10)||0);if(!t&&!e){return}if(config.usePagination){var c=Math.ceil((parseInt(t,10)+1)/config.topicsPerPage);if(parseInt(c,10)!==ajaxify.data.pagination.currentPage){a.loadPage(c,function(){i.scrollToTopic(t,e,0)})}else{i.scrollToTopic(t,e,0)}}else{if(t===0){i.highlightTopic(e);return}$('[component="category"]').empty();n(Math.max(0,t-1)+1,function(){$(window).one("action:topics.loaded",function(){i.scrollToTopic(t,e,0)})})}}}i.highlightTopic=function(o){var e=t.get("category/topic","index",o);if(e.length&&!e.hasClass("highlight")){e.addClass("highlight");setTimeout(function(){e.removeClass("highlight")},5e3)}};i.scrollToTopic=function(o,a,n,c){if(!utils.isNumber(o)){return}if(!c){c=0}var r=t.get("category/topic","index",o);if(r.length){$("html, body").animate({scrollTop:r.offset().top-c+"px"},n!==undefined?n:400,function(){i.highlightTopic(a);e.update()})}};return i});
//# sourceMappingURL=public/src/modules/handleBack.js.map